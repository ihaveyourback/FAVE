<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>My Page - Profile</title>
    <link rel="stylesheet" type="text/css" href="/assets/styles/main.css">
    <link rel="stylesheet" type="text/css" href="/assets/styles/profile.css">
    <link rel="stylesheet" type="text/css" href="/assets/styles/common.css">
    <link rel="stylesheet" type="text/css" href="/assets/styles/index.css">
    <link rel="stylesheet" type="text/css" href="/assets/styles/index/header.css">

    <script defer type="text/javascript" src="/assets/scripts/common.js"></script>
    <script defer type="text/javascript" src="/assets/scripts/profile.js"></script>
</head>
<body>
<div th:insert="~{home/index.main.html :: header}"></div>
<div class="cover" id="cover"></div>
<main>
    <br> <br> <br> <br> <br> <br> <br>
</main>

<main class="main-content">
    <aside class="sidebar">
        <ul class="sidebar__menu">
            <li class="sidebar__item">
                <button class="sidebar__button" data-target="favorites">찜 목록</button>
            </li>
            <li class="sidebar__item">
                <button class="sidebar__button" data-target="posts">내 게시글</button>
            </li>
            <li class="sidebar__item">
                <button class="sidebar__button" data-target="reports">신고 내역</button>
            </li>
            <li class="sidebar__item">
                <button class="sidebar__button" data-target="edit-info">내 정보 수정</button>
            </li>
            <li class="sidebar__item">
                <button class="sidebar__button" data-target="deactivate-account">회원탈퇴</button>
            </li>
        </ul>
    </aside>

    <section class="content">
        <div id="favorites" class="content__section">
            <h2>찜 목록</h2>
            <table class="favorites-table">
                <thead>
                <tr>
                    <th>제목</th>
                    <th>위치</th>
                    <th>축제 일정</th>
                    <th>조회수</th>
                </tr>
                </thead>
                <tbody>
                <tr th:if="${#lists.isEmpty(favoritePosts)}">
                    <td colspan="4">찜한 게시글이 없습니다.</td>
                </tr>
                <tr th:each="post : ${favoritePosts}">
                    <td><a th:href="@{'/fave/read/?index=' + ${post.index}}" th:text="${post.title}">제목</a></td>
                    <td th:text="${post.location}">위치</td>
                    <td th:text="${#temporals.format(post.startDate, 'yyyy-MM-dd')} + ' ~ ' + ${#temporals.format(post.endDate, 'yyyy-MM-dd')}">축제 일정</td>
                    <td th:text="${post.view}">조회수</td>
                </tr>
                </tbody>
            </table>
        </div>

        <div id="posts" class="content__section">
            <h2>내 게시글</h2>
            <table class="posts-table">
                <thead>
                <tr>
                    <th>제목</th>
                    <th>내용</th>
                    <th>작성일</th>
                    <th>조회수</th>
                </tr>
                </thead>
                <tbody>
                <tr th:if="${#lists.isEmpty(posts)}">
                    <td colspan="4">게시글이 없습니다.</td>
                </tr>
                <tr th:each="post : ${posts}">
                    <td th:text="${post.title}">제목</td>
                    <td th:utext="${#strings.abbreviate(post.content, 10)}">내용</td>
                    <td th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
                    <td th:text="${post.view}">조회수</td>
                </tr>
                </tbody>
            </table>
            <div class="pagination">
                <!-- 현재 페이지가 1보다 크면 첫 페이지로 이동하는 버튼을 표시 -->
                <a th:if="${postPageVo.recordsPage > postPageVo.movableMinPage}"
                   th:href="@{'/user/profile?page=1'}">&laquo;&laquo;</a>
                <!-- 현재 페이지가 1보다 크면 이전 페이지로 이동하는 버튼을 표시 -->
                <a th:if="${postPageVo.recordsPage > postPageVo.movableMinPage}"
                   th:href="@{'/user/profile?page=' + ${postPageVo.recordsPage - 1}}">&laquo;</a>
                <!-- 표시할 페이지 번호들을 순회하며 페이지 번호 버튼을 생성 -->
                <a th:each="page : ${#numbers.sequence(postPageVo.displayMinPage, postPageVo.displayMaxPage)}"
                   th:href="@{'/user/profile?page=' + ${page}}"
                   th:text="${page}"
                   th:classappend="${page == postPageVo.recordsPage} ? 'active' : ''"></a>
                <!-- 현재 페이지가 마지막 페이지보다 작으면 다음 페이지로 이동하는 버튼을 표시 -->
                <a th:if="${postPageVo.recordsPage < postPageVo.movableMaxPage}"
                   th:href="@{'/user/profile?page=' + ${postPageVo.recordsPage + 1}}">&raquo;</a>
                <!-- 현재 페이지가 마지막 페이지보다 작으면 마지막 페이지로 이동하는 버튼을 표시 -->
                <a th:if="${postPageVo.recordsPage < postPageVo.movableMaxPage}"
                   th:href="@{'/user/profile?page=' + ${postPageVo.movableMaxPage}}">&raquo;&raquo;</a>
            </div>
        </div>

        <div id="reports" class="content__section">
            <h2>신고 내역</h2>
            <table class="reports-table">
                <thead>
                <tr>
                    <th>신고 대상</th>
                    <th>신고 사유</th>
                    <th>신고 일자</th>
                    <th>상태</th>
                </tr>
                </thead>
                <tbody>
                <tr th:if="${#lists.isEmpty(reports)}">
                    <td colspan="4">신고 내역이 없습니다.</td>
                </tr>
                <tr th:each="report : ${reports}">
                    <td th:text="${report.reportedUserEmail}">상대 이메일</td>
                    <td th:text="${report.reason}">사유</td>
                    <td th:text="${report.reportedAt}">일자</td>
                    <td th:text="${report.status}">상태</td>
                </tr>
                </tbody>
            </table>
            <div class="pagination">
                <!-- 현재 페이지가 1보다 크면 첫 페이지로 이동하는 버튼을 표시 -->
                <a th:if="${reportPageVo.recordsPage > reportPageVo.movableMinPage}"
                   th:href="@{'/user/profile?reportPage=1'}">&laquo;&laquo;</a>
                <!-- 현재 페이지가 1보다 크면 이전 페이지로 이동하는 버튼을 표시 -->
                <a th:if="${reportPageVo.recordsPage > reportPageVo.movableMinPage}"
                   th:href="@{'/user/profile?reportPage=' + ${reportPageVo.recordsPage - 1}}">&laquo;</a>
                <!-- 표시할 페이지 번호들을 순회하며 페이지 번호 버튼을 생성 -->
                <a th:each="page : ${#numbers.sequence(reportPageVo.displayMinPage, reportPageVo.displayMaxPage)}"
                   th:href="@{'/user/profile?reportPage=' + ${page}}"
                   th:text="${page}"
                   th:classappend="${page == reportPageVo.recordsPage} ? 'active' : ''"></a>
                <!-- 현재 페이지가 마지막 페이지보다 작으면 다음 페이지로 이동하는 버튼을 표시 -->
                <a th:if="${reportPageVo.recordsPage < reportPageVo.movableMaxPage}"
                   th:href="@{'/user/profile?reportPage=' + ${reportPageVo.recordsPage + 1}}">&raquo;</a>
                <!-- 현재 페이지가 마지막 페이지보다 작으면 마지막 페이지로 이동하는 버튼을 표시 -->
                <a th:if="${reportPageVo.recordsPage < reportPageVo.movableMaxPage}"
                   th:href="@{'/user/profile?reportPage=' + ${reportPageVo.movableMaxPage}}">&raquo;&raquo;</a>
            </div>
        </div>
        <div id="edit-info" class="content__section">
            <form id="updateForm" class="edit-form">
                <label for="nickname">새로운 닉네임:</label>
                <input type="text" id="nickname" name="nickname" required autocomplete="off">

                <label for="currentPassword">현재 비밀번호:</label>
                <input type="password" id="currentPassword" name="currentPassword" required autocomplete="new-password">

                <label for="newPassword">새 비밀번호:</label>
                <input type="password" id="newPassword" name="newPassword" required autocomplete="new-password">

                <button class="button button--submit" type="submit">변경</button>
            </form>
        </div>

        <div id="deactivate-account" class="content__section">
            <h2>회원탈퇴</h2>
            <p>계정을 탈퇴하시겠습니까? 탈퇴 시 모든 정보가 삭제되며, 복구할 수 없습니다.</p>
            <form id="deactivateForm" class="deactivate-form">
                <label class="deactivate-form__label">
                    <input type="password" class="deactivate-form__input" name="currentPassword" placeholder="현재 비밀번호">
                </label>
                <button type="submit" class="button button--submit">회원탈퇴</button>
            </form>
        </div>
    </section>
</main>

<footer>
    <div class="footer-content">
        <p>김용현 김창윤 김범수 이석민</p>
        <p>고객센터: 123-456-7890</p>
        <p>&copy; 2024 축제잇슈. All Rights Reserved.</p>
        <p>대구광역시 중구 동성로3가 동성로1길 15</p>
    </div>
</footer>

</body>
</html>